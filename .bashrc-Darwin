# have colors on MacOsX
export CLICOLOR=1
export LSCOLORS=ExFxCxDxBxegedabagacad
export SCREENRC=.screenrc-Darwin
export PS1="${USER/xnicollet/xa}@mac:\w"'${debian_chroot:+($debian_chroot)}'"\$ "

alias ssh=my_ssh

# [[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function*

append PATH "/usr/local/go/bin"
export PATH

alias vim='/usr/local/bin/vim'
alias vi='/usr/local/bin/vim'

export EDITOR=/usr/local/bin/vim

# docker run for fpm
# docker run -v $HOME:$HOME --name fpm --rm -t -i xa/fpm bash

# some bash customizations from https://github.com/mrzoo/bash-sensible/

# automatically trim long paths in the prompt (bash 4.x)
PROMPT_DIRTRIM=3

# turn on recursive globbing
shopt -s globstar 2> /dev/null

# Record each line as it gets issued
# PROMPT_COMMAND='history -a'

# correct spelling errors in arguments supplied to cd
shopt -s cdspell 2> /dev/null

alias mount="mount | column -t"

#export VIMPUPPET="~/stack/git/gitlab/puppet/modules/accounts/files/xnicollet/.vimrc"
#alias diffvimrc="vimdiff ~/.vimrc ${VIMPUPPET}"
#alias updatevimrc="cp ~/.vimrc ${VIMPUPPET}"

cdpath=`realpath ~/.cdd_path`
[ -f "$cdpath" ] || touch $cdpath
unalias cdd 2> /dev/null
cdd() {
  [ -n "$1" ] || return
  local dest_dir=$(sed 's/\s*#.*//' < $cdpath | grep -v '^$' | fzf +m +s -1 -q $1 )
  [ -n "$dest_dir" ] && cd "$dest_dir"
}
export -f cdd > /dev/null

unalias cdp 2> /dev/null
cdp() {
  [ -n "$1" ] && dir=`realpath "$1"` || dir=`pwd`
  grep -q -F -x "$dir" $cdpath || echo -e "$dir" >> $cdpath
}
export -f cdp > /dev/null

unalias cdrm 2> /dev/null
cdrm() {
  local filter=""
  [ -n "$1" ] && filter="-q $1"
  local to_rm=`fzf +m $filter < $cdpath`
  # https://unix.stackexchange.com/a/204378/144167
  [ -n "$to_rm" ] && {
    cat < $cdpath | grep -v -F -x -- "$to_rm"
    perl -e 'truncate STDOUT, tell STDOUT'
  } 1<> $cdpath
}
export -f cdrm > /dev/null

unalias cdls 2> /dev/null
cdls() {
  cat $cdpath
}
export -f cdls > /dev/null


